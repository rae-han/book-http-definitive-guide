# 2. URL과 리소스

URL은 인터넷 리소스를 가리키는 표준 이름으로, 전자정보 일부를 가리키고 어디에 있고 어떻게 접근할 수 있는지 알려준다. 이번 장에서 다룰 내용은 아래와 같다.

- URL 문법, 여러 URL 컴포넌트가 어떤 의미를 가지며 무엇을 수행하는지
- 여러 웹 클라이언트가 지원하는 상대 URL과 확장 URL 같은 단축 URL에 대해서
- URL의 인코딩과 문자 규칙
- 여러 인터넷 정보 시스템에 적용되는 공통 URL 스킴
- 기존 이름은 유지하면서 객체들을 다른 장소로 옮기는 것을 가능하게 해주는 URN을 포함한 URL의 미래

# 2.1. 인터넷의 리소스 탐색하기

URL에는 스킴, 호스트, 패스, 쿼리, 프래그먼트가 구성 요소지만, 모두 포함하지 않아도 된다. 스킴, 호스트 필요에 따라 패스 정도가 항상 포함해야 하는 것들이다.

![Untitled](https://s3-us-west-2.amazonaws.com/secure.notion-static.com/3464cc9d-9fce-4f0a-8d69-174f1648a78f/Untitled.png)

아래와 같이 URL은 HTTP 프로토콜이 아닌 다른 프로토콜을 사용할 수도 있다.

- 이메일 - mailto:tamm@google.com
- FPT - ftp:ftp.tamm.com/video/bts-01.avi
- 비디오 서버의 스트리밍 영상 - rtsp://www.tamm.com:43/interview/bts-02.avi

## 2.1.1. URL이 있기 전 암흑의 시대

웹과 URL이 있기 전, 각종 포맷과 프로토콜에 대해 각자 자기만의 중구난방한 리소스 경로를 가졌다.

# 2.2. URL 문법

URL 문법을 좀 더 깊게 들어가면 아래와 같다.

`<**스킴**>://<**사용자 이름**>:<**비밀번호**>@<**호스트**>:<**포트**>/<**경로**>;<**파라미터**>?<**질의**>#<**프래그먼트**>`

사용자 정보는 보안적인 측면에서 잘 사용하지 않는다.

파라미터 같은 경우는 RESTful 한 구조를 가진다면 활용도가 낮다.

## 2.2.1. 스킴: 사용할 프로토콜

## 2.2.2. 호스트와 포트

호스트는 호스트 명이나 IP 주소로 제공한다. 

포트는 항상 필요하지만 생략 가능한데 스킴에 따라 기본 포트를 사용하기 때문이다. http는 80, https는 443 등이 있다.

## 2.2.3. 사용자 이름과 비밀번호

서버는 자신이 가지고 있는 데이터에 접근을 허용하기 전 사용자 이름과 비밀번호를 요구한다.

만약 값이 없다면 기본 사용자 이름 값으로 `anonymous` 비밀번호는 브라우저 마다 다른데 크롬은 `chome@example.com` 을 넣는다.

## 2.2.4. 경로

리소스가 서버의 어디에 있는지 알려준다. 유닉스 파일 시스템 경로와 유사하게 설계 되었다.

## 2.2.5. 파라미터

이름/값 쌍의 리스트로 ; 문자로 구별한다. 어플리케이션 리소스에 접근하는데 필요한 추가 정보를 전달할 수 있다. path 사이사이에 등록하는 것도 가능하다.

https//kakao.com/chat;type=dm/period;value=lastYear

## 2.2.6. 질의 문자열

주로 검색 질의로 많이 사용한다. 보통 ? 뒤에 이름=값 쌍 형태로 작성하며 &로 구분하여 여러 값을 넣을수 있다.

## 2.2.7. 프래그먼트

유일하게 서버로 전달하지 않는 값으로, 브라우저 내부에서 사용하는 문맥이다. 리소스 안의 특정 절을 가리킬수 있다. (ex. https://kakao.com#footer)

이를 응용하여 SPA이 개발한다고 한다.

# 2.3. 단축 URL

## 2.3.1. 상대 URL

기저 URL의 통해 URL의 모든 정보를 작성하지 않고 리소스에 접근하는 방법

예를 들면 https://kakao.com/index.html 에서  https://kakao.com/contact.html 에 접근하기 위해 모든 URL을 다 사용하지 않고 ./contact.html 만 적어주는 방식이다.

## 2.3.2. URL 확장

브라우저의 URL 자동완성 기능을 생각하면 간단하다. www 같은 서브 네임을 자동으로 입력해주는 것은 호스트명 확장, 단어만 입력해도 history에서 hit된 것들로 후보지를 보여주는 것은 히스토리 확장이다. 크롬 같은 경우 URL에 단어만 입력해도 단어를 검색하는 검색 URL을 만들어서 처리한다.

# 2.4. 안전하지 않은 문자

URL에서 특정 목적으로 사용하는 값과 안전하지 않은 값이 있다. 예를들면 :은 스킴 다음에 나오는 값, ?은 쿼리를 나타내는 값으로 URL 안에서 다른 용도로 사용할 수 없다.

이 밖에 대부분의 문자는 안전하지 않은 문자로 분류한다. 이유는 URL이 메일이나 ftp 등도 포함하는 넓은 개념이기 때문이다. 예를 들어 메일에서 허용하지 않는 값을 URL에서 사용하면 URL은 메일 주소를 올바르게 처리할 수 없다. 우리는 메일에서만 문제가 발생한다고 하더라도 이런 값은 장기적으로 문제를 일이킬 수 있다. 이런 값을 안전하지 않은 갑이라 한다.

서비스의 안전성을 위해서 항상 안전한 값으로 변경해서 처리해야 한다. 안전한 값은 영어와 몇몇 기호들이라 생각하면 된다.

## 2.4.1. URL 문자 집합

기본적으로 컴퓨터 시스템의 기본 문자 집합은 영어로 설정되어 있기 때문에 영어와 영문 자판에 있는 키 대부분을 포함한다. 이 외의 문자는 인코딩하여 사용한다.

## 2.4.2. 인코딩 체계

URL에서 안전하지 않는 문자를 다른 문자로 치환하는 것을 URL 인코딩이라 한다. 스킴을 구분하는 :는 %3A로 인코딩 되는 식이다.

## 2.4.3. 문자 제한

몇몇 문자는 예악어이다. 본래의 목적이 아닌 다른 용도로 사용하려면 반드시 인코딩 해야한다. 예를 들면 질의 문자열의 구획 문자인 ?이 있다.

## 2.4.4. 좀 더 알아보기

어떤 요청을 받은 어플리케이션에서 안전하지 않은 문자를 인코딩하지 않는 것은 실수다. 서버에서도 안전하지 않은 문자가 있는지 검증해야 하는 것이 맞다.

# 2.5. 스킴의 바다

스킴마다 포맷이 다르다. 위에서는 URL을 예시로 들었는데 스킴모다 구성요소가 다르다.

://:@:/;?#

ftp://anonymous:tamm%40tammo.com@tamm.com/files/bts-01.avi

news:rec.arts.tarktrek

ftp 같은 스킴은 @문자가 %40으로 인코딩 된다. news 스킴은 호스트가 없는 형태로 리소스 위치 정보가 충분히 없다.(중요지 않음)

# 2.6. 미래

URL은 강력한 도구로 유용하고 널리 사용된다. 하지만 리소스의 위치가 변경되면 URL을 찾을 수 없는 문제가 있다. 이를 위해 URN의 개념이 도입되었지만, URL을 대체하는 것은 어려워 보인다.

## 2.6.1. 지금이 아니면 언제??

URL은 나름의 한계를 가지고 있지만 당분간 계속 사용될 예정이다.